<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GrabGo - Instant Local Pickup & Delivery | Shillong</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fcfcfc; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-scale-up { animation: scaleUp 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes scaleUp { from { opacity: 0; scale: 0.95; } to { opacity: 1; scale: 1; } }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.460.0"
      }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import ReactDOM from 'react-dom/client';
        import * as Lucide from 'lucide-react';

        const { 
            Package, LayoutDashboard, History, ShieldCheck, LogOut, 
            Search, Filter, RefreshCcw, CheckCircle, Truck, XCircle, 
            DollarSign, ChevronRight, MapPin, Clock, IndianRupee, 
            ArrowLeft, Send, CreditCard, ShoppingBag, ShoppingCart 
        } = Lucide;

        // --- CONSTANTS & DATA ---
        const ADMIN_EMAIL = "admin@grabgo.in";
        const OrderStatus = { PENDING: 'Pending', IN_PROGRESS: 'In Progress', DELIVERED: 'Delivered', CANCELLED: 'Cancelled' };
        const PaymentStatus = { PAID: 'Paid', UNPAID: 'Unpaid' };
        const UrgencyType = { NORMAL: 'Normal', EXPRESS: 'Express' };

        const SERVICE_CATEGORIES = [
          { id: 'food', name: 'Food & Cafe', description: 'From your favorite local cafes to your doorstep.', icon: 'ShoppingBag', bgColor: 'bg-rose-50', hoverBorder: 'hover:border-rose-200' },
          { id: 'grocery', name: 'Groceries', description: 'Daily essentials from local markets.', icon: 'ShoppingCart', bgColor: 'bg-emerald-50', hoverBorder: 'hover:border-emerald-200' },
          { id: 'pharmacy', name: 'Pharmacy', description: 'Medicines delivered safely and quickly.', icon: 'Clock', bgColor: 'bg-blue-50', hoverBorder: 'hover:border-blue-200' },
          { id: 'pickup', name: 'Pick & Drop', description: 'Send anything across Shillong instantly.', icon: 'MapPin', bgColor: 'bg-[#f2ca52]/10', hoverBorder: 'hover:border-[#f2ca52]' },
          { id: 'others', name: 'Others', description: 'Custom requests for unique needs.', icon: 'Package', bgColor: 'bg-gray-50', hoverBorder: 'hover:border-gray-200' }
        ];

        const getServiceIcon = (iconName) => {
          const icons = { ShoppingBag: <ShoppingBag />, ShoppingCart: <ShoppingCart />, Clock: <Clock />, MapPin: <MapPin />, Package: <Package /> };
          return icons[iconName] || <Package />;
        };

        // --- SUB-COMPONENTS ---

        const Navbar = ({ user, currentView, onNavigate, onLogout }) => (
            <nav className="bg-white/90 backdrop-blur-md shadow-sm border-b sticky top-0 z-50">
                <div className="container mx-auto px-4 max-w-4xl flex justify-between items-center h-20">
                    <div className="flex items-center space-x-3 cursor-pointer group" onClick={() => onNavigate('dashboard')}>
                        <div className="bg-[#f2ca52] p-2 rounded-xl shadow-md group-hover:scale-105 transition-transform"><Package className="w-6 h-6 text-black" /></div>
                        <span className="text-2xl font-black text-gray-900 tracking-tighter">GrabGo</span>
                    </div>
                    <div className="flex items-center space-x-1 sm:space-x-4">
                        <button onClick={() => onNavigate('dashboard')} className={`p-3 rounded-2xl transition-all flex items-center space-x-2 ${currentView === 'dashboard' ? 'bg-[#f2ca52] text-black shadow-lg font-black' : 'text-gray-500 hover:bg-[#f2ca52] hover:text-black font-bold'}`}><LayoutDashboard className="w-5 h-5" /><span className="hidden sm:inline text-sm tracking-tight">Home</span></button>
                        <button onClick={() => onNavigate('history')} className={`p-3 rounded-2xl transition-all flex items-center space-x-2 ${currentView === 'history' ? 'bg-[#f2ca52] text-black shadow-lg font-black' : 'text-gray-500 hover:bg-[#f2ca52] hover:text-black font-bold'}`}><History className="w-5 h-5" /><span className="hidden sm:inline text-sm tracking-tight">Orders</span></button>
                        {user.isAdmin && <button onClick={() => onNavigate('admin')} className={`p-3 rounded-2xl transition-all flex items-center space-x-2 ${currentView === 'admin' ? 'bg-black text-[#f2ca52] shadow-lg font-black' : 'text-gray-500 hover:bg-[#f2ca52] hover:text-black font-bold'}`}><ShieldCheck className="w-5 h-5" /><span className="hidden sm:inline text-sm tracking-tight">Admin</span></button>}
                        <button onClick={onLogout} className="p-3 rounded-2xl text-red-500 hover:bg-red-50 transition-all active:scale-90"><LogOut className="w-5 h-5" /></button>
                    </div>
                </div>
            </nav>
        );

        const HomeView = ({ onLogin }) => {
            const handleGoogleSignIn = () => {
                // 1. Get the email from a prompt (or your auth system)
                const email = prompt("Enter your email to sign in:", "biswajit.mgla@gmail.com");
                
                if (email) {
                    // 2. Extract the name: take everything before the "." or "@"
                    // biswajit.mgla -> Biswajit
                    const extractedName = email.split(/[.@]/)[0];
                    const formattedName = extractedName.charAt(0).toUpperCase() + extractedName.slice(1);

                    const mockUser = {
                        id: Math.random().toString(36).substr(2, 9),
                        name: formattedName, // This now uses your email name!
                        email: email,
                        photo: `https://api.dicebear.com/7.x/avataaars/svg?seed=${extractedName}`,
                        isAdmin: email === ADMIN_EMAIL
                    };
                    onLogin(mockUser);
                }
            };

            return (
                <div className="flex flex-col items-center justify-center min-h-[80vh] text-center px-4 animate-fade-in">
                    <div className="mb-10 w-32 h-32 bg-[#f2ca52] rounded-3xl shadow-xl flex items-center justify-center">
                        <Package className="w-16 h-16 text-black" />
                    </div>
                    <h1 className="text-6xl font-black text-gray-900 mb-2 tracking-tighter">GrabGo</h1>
                    <p className="text-xl font-bold text-gray-500 mb-12 max-w-sm leading-relaxed uppercase tracking-tight">Quick Pickup & Dropping Service</p>
                    <div className="flex flex-col space-y-4 w-full max-w-xs">
                        <button onClick={handleGoogleSignIn} className="flex items-center justify-center space-x-3 bg-[#f2ca52] text-black py-4 px-6 rounded-2xl shadow-lg font-bold hover:bg-black hover:text-[#f2ca52] transition-all">
                            <img src="https://www.google.com/favicon.ico" className="w-5 h-5" />
                            <span>Sign in with Google</span>
                        </button>
                        <button onClick={() => onLogin({ id: "admin-123", name: "Admin", email: ADMIN_EMAIL, isAdmin: true })} className="text-[10px] text-gray-300 hover:text-gray-500 transition-colors mt-12 uppercase tracking-widest font-bold">Administrator Access</button>
                    </div>
                </div>
            );
        };

        const DashboardView = ({ user, onSelectService }) => (
            <div className="space-y-8 animate-fade-in">
                <div className="bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-100 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6">
                    <div>
                        <div className="flex items-center space-x-2 mb-1"><MapPin size={14} className="text-[#f2ca52]" /><span className="text-[10px] font-black text-gray-400 uppercase tracking-[0.2em]">Current Location: Shillong</span></div>
                        <h2 className="text-3xl font-black text-gray-900 tracking-tight">Kumno, {user.name.split(' ')[0]}!</h2>
                        <p className="text-gray-500 mt-1 font-medium">What can we grab for you today?</p>
                    </div>
                    <div className="flex -space-x-2">
                        <div className="w-12 h-12 rounded-2xl border-4 border-white bg-[#f2ca52] flex items-center justify-center shadow-md"><Package className="w-6 h-6 text-black" /></div>
                        {user.photo && <img src={user.photo} className="w-12 h-12 rounded-2xl border-4 border-white shadow-md object-cover" />}
                    </div>
                </div>
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    {SERVICE_CATEGORIES.map((service) => (
                        <button key={service.id} onClick={() => onSelectService(service.id)} className={`flex flex-col items-start p-8 ${service.bgColor} rounded-[2.5rem] border-2 border-transparent ${service.hoverBorder} hover:shadow-xl transition-all duration-300 text-left group relative overflow-hidden`}>
                            <div className="p-4 rounded-2xl bg-white shadow-sm group-hover:scale-110 transition-transform mb-6 relative z-10">{getServiceIcon(service.icon)}</div>
                            <h3 className="text-2xl font-black text-gray-900 mb-1 tracking-tight relative z-10">{service.name}</h3>
                            <p className="text-gray-600 text-sm font-medium mb-6 leading-relaxed relative z-10">{service.description}</p>
                            <div className="mt-auto flex items-center bg-white text-black font-bold text-xs group-hover:bg-black group-hover:text-[#f2ca52] transition-all px-5 py-3 rounded-xl shadow-sm relative z-10">Book Delivery <ChevronRight className="w-4 h-4 ml-1" /></div>
                        </button>
                    ))}
                </div>
                <div className="bg-black rounded-[2.5rem] p-10 text-white flex flex-col md:flex-row items-center justify-between shadow-2xl relative group overflow-hidden">
                    <div className="relative z-10">
                        <div className="bg-[#f2ca52] text-black text-[9px] font-black uppercase px-3 py-1 rounded-full w-max mb-4">Membership</div>
                        <h3 className="text-3xl font-black mb-3 tracking-tight">GrabGo Prime</h3>
                        <p className="text-gray-400 max-w-sm font-medium leading-relaxed">Coming soon to Shillong! Get flat ₹80 delivery for all your monthly errands.</p>
                    </div>
                    <button className="mt-8 md:mt-0 bg-[#f2ca52] text-black px-8 py-4 rounded-2xl font-black hover:bg-white hover:text-black transition-all relative z-10">Notify Me</button>
                    <div className="absolute -right-10 -bottom-10 opacity-10 transform group-hover:rotate-12 transition-transform duration-700"><Package size={240} /></div>
                </div>
            </div>
        );

        const OrderFormView = ({ user, serviceId, onSubmit, onCancel }) => {
            const service = SERVICE_CATEGORIES.find(s => s.id === serviceId) || SERVICE_CATEGORIES[4];
            const [formData, setFormData] = useState({ fullName: user.name, mobileNumber: '', itemDescription: '', urgency: UrgencyType.NORMAL, fromAddress: '', fromPincode: '', toAddress: '', toPincode: '' });
            const [step, setStep] = useState('details');

            const amount = formData.urgency === UrgencyType.EXPRESS ? 180 : 100;

            const handleSubmit = (e) => { e.preventDefault(); setStep('payment'); };
            const confirmOrder = () => {
                onSubmit({ id: `ORD-${Math.random().toString(36).substr(2, 6).toUpperCase()}`, userEmail: user.email, userName: formData.fullName, userPhone: formData.mobileNumber, serviceType: service.name, itemDescription: formData.itemDescription, urgency: formData.urgency, fromAddress: formData.fromAddress, fromPincode: formData.fromPincode, toAddress: formData.toAddress, toPincode: formData.toPincode, status: OrderStatus.PENDING, amount: amount, paymentStatus: PaymentStatus.UNPAID, timestamp: new Date().toISOString() });
            };

            const sleekInput = "w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl focus:border-black focus:bg-white text-black font-medium outline-none transition-all placeholder:text-gray-400";

            if (step === 'payment') return (
                <div className="bg-white rounded-[2.5rem] shadow-2xl p-10 max-w-md mx-auto animate-scale-up border border-gray-100">
                    <h2 className="text-3xl font-black mb-6 text-center tracking-tight">Checkout</h2>
                    <div className="bg-gray-50 rounded-3xl p-8 mb-8 border-2 border-dashed border-gray-200">
                        <div className="flex justify-between mb-3"><span className="text-gray-500 font-medium">Service</span><span className="font-bold text-black">{service.name}</span></div>
                        <div className="flex justify-between mb-3"><span className="text-gray-500 font-medium">Urgency</span><span className={formData.urgency === UrgencyType.EXPRESS ? 'text-red-600 font-black' : 'text-black font-black'}>{formData.urgency}</span></div>
                        <div className="border-t-2 border-gray-100 pt-4 mt-4 flex justify-between items-center"><span className="text-lg font-bold text-gray-800">Total</span><span className="text-3xl font-black text-black">₹{amount}</span></div>
                    </div>
                    <div className="space-y-4">
                        <button onClick={confirmOrder} className="flex items-center justify-center space-x-3 w-full bg-[#f2ca52] text-black py-5 rounded-[1.5rem] font-black hover:bg-black hover:text-[#f2ca52] transition-all shadow-xl active:scale-95"><CreditCard className="w-6 h-6" /><span>Pay with UPI</span></button>
                        <button onClick={confirmOrder} className="w-full bg-gray-100 text-gray-800 py-4 rounded-[1.5rem] font-bold hover:bg-black hover:text-white transition-all">Pay on Delivery</button>
                        <button onClick={() => setStep('details')} className="w-full text-gray-400 py-2 text-xs hover:text-gray-600 font-medium">Modify order details</button>
                    </div>
                </div>
            );

            return (
                <div className="space-y-6 animate-fade-in">
                    <button onClick={onCancel} className="flex items-center text-gray-400 hover:text-black font-bold transition-colors group"><ArrowLeft className="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" /> Back</button>
                    <div className="bg-white rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden">
                        <div className={`${service.bgColor} p-8 border-b border-gray-100`}><h2 className="text-3xl font-black text-gray-900 tracking-tight">New {service.name} Request</h2><p className="text-gray-500 font-medium mt-1">Reliable pickup across Shillong city limits.</p></div>
                        <form onSubmit={handleSubmit} className="p-10 space-y-10">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div><label className="block text-xs font-black uppercase tracking-widest text-gray-400 mb-2 ml-1">Full Name</label><input type="text" value={formData.fullName} onChange={(e) => setFormData({...formData, fullName: e.target.value})} required className={sleekInput} /></div>
                                <div><label className="block text-xs font-black uppercase tracking-widest text-gray-400 mb-2 ml-1">Mobile Number</label><input type="tel" value={formData.mobileNumber} onChange={(e) => setFormData({...formData, mobileNumber: e.target.value})} required placeholder="9876543210" className={sleekInput} /></div>
                            </div>
                            <div className="space-y-6">
                                <div><label className="block text-xs font-black uppercase tracking-widest text-gray-400 mb-2 ml-1">Item Description</label><textarea value={formData.itemDescription} onChange={(e) => setFormData({...formData, itemDescription: e.target.value})} required rows={2} placeholder={`What are we picking up?`} className={sleekInput + " resize-none"} /></div>
                                <div><label className="block text-xs font-black uppercase tracking-widest text-gray-400 mb-2 ml-1">Urgency</label><select value={formData.urgency} onChange={(e) => setFormData({...formData, urgency: e.target.value})} className={sleekInput}><option value={UrgencyType.NORMAL}>Normal (₹100)</option><option value={UrgencyType.EXPRESS}>Express (₹180)</option></select></div>
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-10">
                                <div className="space-y-4"><div className="bg-emerald-50 text-emerald-700 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest w-max">Pickup</div><input type="text" value={formData.fromAddress} onChange={(e) => setFormData({...formData, fromAddress: e.target.value})} required placeholder="Full Address" className={sleekInput} /><input type="text" value={formData.fromPincode} onChange={(e) => setFormData({...formData, fromPincode: e.target.value})} required maxLength={6} placeholder="793001" className={sleekInput} /></div>
                                <div className="space-y-4"><div className="bg-orange-50 text-orange-700 px-4 py-1.5 rounded-full text-[10px] font-black uppercase tracking-widest w-max">Delivery</div><input type="text" value={formData.toAddress} onChange={(e) => setFormData({...formData, toAddress: e.target.value})} required placeholder="Full Address" className={sleekInput} /><input type="text" value={formData.toPincode} onChange={(e) => setFormData({...formData, toPincode: e.target.value})} required maxLength={6} placeholder="793010" className={sleekInput} /></div>
                            </div>
                            <button type="submit" className="w-full bg-[#f2ca52] text-black py-5 rounded-[1.5rem] font-black text-lg flex items-center justify-center space-x-3 hover:bg-black hover:text-[#f2ca52] transition-all shadow-2xl active:scale-[0.98]"><span>Proceed to Checkout</span><Send className="w-5 h-5" /></button>
                        </form>
                    </div>
                </div>
            );
        };

        const HistoryView = ({ user, orders }) => {
          const userOrders = orders.filter(o => o.userEmail === user.email);
          const getStatusColor = (status) => {
            switch (status) {
              case OrderStatus.PENDING: return 'bg-yellow-100 text-yellow-700';
              case OrderStatus.IN_PROGRESS: return 'bg-blue-100 text-blue-700';
              case OrderStatus.DELIVERED: return 'bg-green-100 text-green-700';
              case OrderStatus.CANCELLED: return 'bg-red-100 text-red-700';
              default: return 'bg-gray-100 text-gray-700';
            }
          };

          return (
            <div className="space-y-6 animate-fade-in">
              <div className="flex flex-col md:flex-row md:items-center justify-between mb-8"><h2 className="text-3xl font-bold text-gray-900">Your Orders</h2><p className="text-gray-500 mt-1 md:mt-0">{userOrders.length} orders total</p></div>
              {userOrders.length === 0 ? (
                <div className="bg-white p-12 rounded-3xl text-center border-2 border-dashed border-gray-100"><Package size={48} className="text-gray-300 mx-auto mb-4" /><h3 className="text-xl font-bold text-gray-600">No orders found</h3></div>
              ) : (
                <div className="space-y-4">
                  {userOrders.map((order) => (
                    <div key={order.id} className="bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
                      <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4 border-b pb-4">
                        <div className="flex items-center space-x-3"><span className="text-xs font-bold text-gray-400 tracking-widest">{order.id}</span><h3 className="text-lg font-bold text-gray-900">{order.serviceType}</h3></div>
                        <div className="flex items-center space-x-3"><span className={`px-4 py-1.5 rounded-full text-xs font-bold ${getStatusColor(order.status)}`}>{order.status}</span><span className={`px-4 py-1.5 rounded-full text-xs font-bold ${order.paymentStatus === 'Paid' ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-700'}`}>{order.paymentStatus}</span></div>
                      </div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div className="space-y-3">
                          <div className="flex items-start space-x-3"><MapPin className="w-5 h-5 text-blue-500 shrink-0 mt-0.5" /><div className="text-sm"><p className="text-xs text-gray-400 uppercase font-bold">From</p><p className="text-gray-700 font-medium">{order.fromAddress}, {order.fromPincode}</p></div></div>
                          <div className="flex items-start space-x-3"><MapPin className="w-5 h-5 text-orange-500 shrink-0 mt-0.5" /><div className="text-sm"><p className="text-xs text-gray-400 uppercase font-bold">To</p><p className="text-gray-700 font-medium">{order.toAddress}, {order.toPincode}</p></div></div>
                        </div>
                        <div className="flex items-end justify-between border-t md:border-t-0 pt-4 md:pt-0">
                           <div className="flex items-center text-gray-500 space-x-2"><Clock size={16} /><span className="text-xs">{new Date(order.timestamp).toLocaleDateString()}</span></div>
                           <div className="flex items-center text-blue-600 font-extrabold text-xl"><IndianRupee size={18} /><span>{order.amount}</span></div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          );
        };

        const AdminView = ({ orders, onUpdateOrder }) => {
          const [searchTerm, setSearchTerm] = useState('');
          const filteredOrders = orders.filter(o => o.id.toLowerCase().includes(searchTerm.toLowerCase()) || o.userName.toLowerCase().includes(searchTerm.toLowerCase()));
          const stats = { total: orders.length, pending: orders.filter(o => o.status === OrderStatus.PENDING).length, delivered: orders.filter(o => o.status === OrderStatus.DELIVERED).length, revenue: orders.reduce((acc, o) => o.paymentStatus === PaymentStatus.PAID ? acc + o.amount : acc, 0) };

          return (
            <div className="space-y-8 animate-fade-in">
              <div className="flex flex-col md:flex-row md:items-center justify-between"><h2 className="text-3xl font-black text-gray-900 tracking-tight">Admin Dashboard</h2><div className="relative mt-4 md:mt-0"><Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5" /><input type="text" placeholder="Search..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="pl-10 pr-4 py-3 border-2 border-gray-100 rounded-2xl w-full md:w-64" /></div></div>
              <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
                {[ { label: 'Total', value: stats.total, color: 'text-black', bg: 'bg-white' }, { label: 'Pending', value: stats.pending, color: 'text-black', bg: 'bg-[#f2ca52]' }, { label: 'Completed', value: stats.delivered, color: 'text-green-600', bg: 'bg-green-50' }, { label: 'Revenue (₹)', value: stats.revenue, color: 'text-black', bg: 'bg-white' } ].map((s, idx) => (
                  <div key={idx} className={`p-6 rounded-[2rem] ${s.bg} border-2 border-gray-50 shadow-sm`}><p className="text-[10px] font-black uppercase tracking-widest text-gray-500 mb-1">{s.label}</p><p className={`text-3xl font-black ${s.color}`}>{s.value}</p></div>
                ))}
              </div>
              <div className="bg-white rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden overflow-x-auto">
                <table className="w-full text-left"><thead className="bg-gray-50 text-[10px] font-black uppercase tracking-widest text-gray-400 border-b"><tr><th className="px-8 py-5">Order/User</th><th className="px-6 py-5">Status</th><th className="px-6 py-5">Payment</th><th className="px-8 py-5 text-center">Actions</th></tr></thead>
                  <tbody className="divide-y divide-gray-50">
                    {filteredOrders.map((order) => (
                      <tr key={order.id} className="hover:bg-gray-50"><td className="px-8 py-5"><div className="font-black text-gray-900">{order.id}</div><div className="text-gray-400 text-xs">{order.userName}</div></td><td className="px-6 py-5"><span className={`px-4 py-1.5 rounded-full text-[10px] font-black uppercase ${order.status === OrderStatus.PENDING ? 'bg-[#f2ca52] text-black' : order.status === OrderStatus.DELIVERED ? 'bg-green-100 text-green-700' : 'bg-black text-white'}`}>{order.status}</span></td><td className="px-6 py-5"><button onClick={() => onUpdateOrder(order.id, { paymentStatus: order.paymentStatus === PaymentStatus.PAID ? PaymentStatus.UNPAID : PaymentStatus.PAID })} className={`px-4 py-1.5 rounded-full text-[10px] font-black uppercase transition-all ${order.paymentStatus === PaymentStatus.PAID ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}`}>{order.paymentStatus}</button></td><td className="px-8 py-5 flex items-center justify-center space-x-1"><button onClick={() => onUpdateOrder(order.id, { status: OrderStatus.IN_PROGRESS })} className="p-2 text-black hover:bg-[#f2ca52] rounded-xl"><Truck size={20} /></button><button onClick={() => onUpdateOrder(order.id, { status: OrderStatus.DELIVERED })} className="p-2 text-green-600 hover:bg-green-50 rounded-xl"><CheckCircle size={20} /></button><button onClick={() => onUpdateOrder(order.id, { status: OrderStatus.CANCELLED })} className="p-2 text-red-400 hover:bg-red-50 rounded-xl"><XCircle size={20} /></button></td></tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          );
        };

        // --- MAIN APP ---

        const App = () => {
          const [user, setUser] = useState(null);
          const [currentView, setCurrentView] = useState('home');
          const [selectedService, setSelectedService] = useState(null);
          const [orders, setOrders] = useState([]);

          useEffect(() => {
            const savedOrders = localStorage.getItem('grabgo_orders');
            if (savedOrders) setOrders(JSON.parse(savedOrders));
          }, []);

          useEffect(() => {
            localStorage.setItem('grabgo_orders', JSON.stringify(orders));
          }, [orders]);

          const handleLogin = (mockUser) => { setUser(mockUser); setCurrentView('dashboard'); };
          const handleLogout = () => { setUser(null); setCurrentView('home'); };
          const createOrder = (newOrder) => { setOrders(prev => [newOrder, ...prev]); setCurrentView('history'); };
          const updateOrder = (orderId, updates) => { setOrders(prev => prev.map(o => o.id === orderId ? { ...o, ...updates } : o)); };

          const renderView = () => {
            if (!user) return <HomeView onLogin={handleLogin} />;
            switch (currentView) {
              case 'dashboard': return <DashboardView user={user} onSelectService={(id) => { setSelectedService(id); setCurrentView('order-form'); }} />;
              case 'order-form': return <OrderFormView user={user} serviceId={selectedService || 'others'} onSubmit={createOrder} onCancel={() => setCurrentView('dashboard')} />;
              case 'history': return <HistoryView user={user} orders={orders} />;
              case 'admin': return user.isAdmin ? <AdminView orders={orders} onUpdateOrder={updateOrder} /> : <DashboardView user={user} onSelectService={() => {}} />;
              default: return <DashboardView user={user} onSelectService={() => {}} />;
            }
          };

          return (
            <div className="min-h-screen bg-gray-50 flex flex-col">
              {user && <Navbar user={user} currentView={currentView} onNavigate={setCurrentView} onLogout={handleLogout} />}
              <main className="flex-grow container mx-auto px-4 py-8 max-w-4xl">
                {renderView()}
              </main>
              <footer className="bg-white border-t py-6 text-center text-gray-500 text-sm">
                <p>&copy; {new Date().getFullYear()} GrabGo Shillong. Instant Pick & Drop.</p>
              </footer>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
